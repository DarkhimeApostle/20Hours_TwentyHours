# 自动导出配置功能

## 功能概述

应用现在支持在技能变动时自动导出配置，确保用户数据的安全性和可恢复性。

## 功能特点

### 1. 自动导出时机
- **应用启动10秒后**：应用启动后会自动导出一次配置
- **技能变动时**：当用户添加、编辑、删除技能时，会自动导出配置

### 2. 导出内容
自动导出的配置文件包含以下内容：
- 用户信息（用户名，但不包含头像和侧边栏背景）
- 所有技能数据（主页面和荣耀殿堂的技能）
- 技能日记
- 技能分组信息
- 已祝贺的技能ID列表

### 3. 导出位置
- 配置文件保存在应用内部存储目录的 `t20_backup` 文件夹中
- 文件名为 `config.json`
- 不包含头像和侧边栏背景图片文件

## 技术实现

### 核心组件

1. **ConfigExporter 工具类** (`lib/utils/config_exporter.dart`)
   - 提供 `autoExportConfig()` 静态方法
   - 负责收集和导出配置数据
   - 处理文件操作和错误处理

2. **自动导出触发机制**
   - 在 `RootScreen` 的 `initState()` 中启动10秒定时器
   - 在 `HomeScreen` 的 `saveSkills()` 方法中调用自动导出
   - 确保在技能变动时及时更新配置

### 代码结构

```dart
// 自动导出配置（不包含头像和侧边栏背景）
static Future<void> autoExportConfig() async {
  // 1. 创建备份目录
  // 2. 收集配置数据
  // 3. 保存配置文件
  // 4. 错误处理
}
```

## 使用说明

### 对于用户
- 功能完全自动化，无需用户手动操作
- 配置文件会在后台自动更新
- 可以通过设置页面的"导出配置"功能手动导出完整备份（包含图片）

### 对于开发者
- 自动导出功能不会影响应用性能
- 导出过程在后台异步执行
- 包含完整的错误处理和日志记录

## 文件结构

```
应用文档目录/
└── t20_backup/
    └── config.json  # 自动导出的配置文件
```

## 注意事项

1. **存储空间**：自动导出会定期更新配置文件，但不会累积多个备份文件
2. **权限要求**：使用应用内部存储，无需额外权限
3. **数据完整性**：只导出配置数据，不包含图片文件
4. **错误处理**：导出失败不会影响应用的正常使用

## 未来改进

- 可以考虑添加配置版本管理
- 支持增量备份以减少存储空间使用
- 添加导出成功/失败的用户通知 